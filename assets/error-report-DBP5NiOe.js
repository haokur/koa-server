import{d as A,g,i as O,c as d,a as e,n as L,p as k,w,F as j,r as B,t as o,b as J,o as u,f as x,z as M,q as H,s as K,A as Q,_ as W}from"./index-BxD6fV-S.js";var F={NODE_ENV:"production",title:"生产环境",baseUrl:"https://api.haokur.com",workerBaseUrl:"workers"};const h=f=>(H("data-v-3c2c01c8"),f=f(),K(),f),X={class:"error-report"},Y={class:"report-control"},Z=["src"],ee={class:"report-showcase mt20"},te={class:"report-showcase__wrap"},se={class:"report-showcase__list"},oe=["onClick"],ne={class:"message"},ce=["href"],le={class:"time"},ae={class:"report-showcase__detail"},re={class:"log-list"},ie={class:"log-row"},_e=h(()=>e("label",{class:"label"},"报错信息：",-1)),de={class:"content"},ue={class:"log-row"},he=h(()=>e("label",{class:"label"},"访问页面链接：",-1)),pe=["href"],ve={class:"log-row"},ge=h(()=>e("label",{class:"label"},"触发时间：",-1)),fe={class:"content"},me={class:"log-row"},be=h(()=>e("label",{class:"label"},"来源：",-1)),ke={class:"content"},we={class:"log-row"},xe=h(()=>e("label",{class:"label"},"类型：",-1)),Ce={class:"content"},ye={class:"log-row"},Le=h(()=>e("label",{class:"label"},"触发元素：",-1)),$e={class:"content"},Ue={class:"log-row stack"},Se=h(()=>e("label",{class:"label"},"调用堆栈：",-1)),Pe={class:"content"},Ee=["onClick"],Ie={key:0,class:"stack-item__source"},Ne={key:1,class:"stack-item__source"},je=["href"],Be={class:"log-row"},Fe=h(()=>e("label",{class:"label"},"userAgent：",-1)),Ve={class:"content"},De=A({__name:"error-report",setup(f){const C=g("");O(()=>{U()});function V(){console.log(foo)}function D(){C.value="https://abc.com/a.png"}function G(){return new Promise((s,n)=>{n("This is an unhandled rejection")})}const $=g([]),c=g(null);async function U(){const n=await(await fetch(`${F.baseUrl}/log/query`)).json();$.value=n.list.map(t=>({...t,content:JSON.parse(decodeURIComponent(t.content))}))}function R(s){c.value=s,m.value=[],p.value=[]}function S(...s){return s.reduce((t,l)=>(l.split("/").forEach(a=>{a===".."?t.pop():a!=="."&&t.push(a)}),t),[]).join("/")}function T(s){const n="/Users/haokur/code/Github/koa-server/client/xxxx/xxxx";let{source:t,line:l,column:_}=s,v=`${"/"+S(n,t)}:${l}:${_}`,b=`code -g ${v}`;return Q(b),`code -g ${v}`}function q(s){let{source:n,line:t}=s;return`${S("https://github.com/haokur/koa-server/blob/main/client/xxxx/xxxx",n)}#L${t}`}const m=g([]),p=g([]);async function z(s,n){console.log(s,"error-report.vue::122行");let l=await(await fetch(`${F.baseUrl}/log/parse-sourcemap?bundle_path=${s}`)).json();const _=T(l),a=q(l);m.value[n]=_,p.value[n]=a}return(s,n)=>{var l,_,a,v,b,P,E,I,N;const t=J("el-button");return u(),d("div",X,[e("div",Y,[C.value?(u(),d("img",{key:0,class:"img",src:C.value},null,8,Z)):L("",!0),k(t,{onClick:V},{default:w(()=>[x("window.onerror捕获")]),_:1}),k(t,{onClick:D},{default:w(()=>[x("window.addEventListener捕获")]),_:1}),k(t,{onClick:G},{default:w(()=>[x("promise-reject未处理捕获")]),_:1})]),e("div",ee,[k(t,{type:"primary",onClick:U},{default:w(()=>[x("刷新日志")]),_:1}),e("div",te,[e("ul",se,[(u(!0),d(j,null,B($.value,(r,i)=>{var y;return u(),d("li",{class:M(["report-showcase__item",{active:r.id===((y=c.value)==null?void 0:y.id)}]),onClick:Ge=>R(r),key:i},[e("h4",ne,o(r.content.message),1),e("a",{class:"link",href:r.content.href},o(r.content.href),9,ce),e("div",le,o(r.content.time),1)],10,oe)}),128))]),e("div",ae,[e("div",re,[e("h3",ie,[_e,e("span",de,o((l=c.value)==null?void 0:l.content.message),1)]),e("div",ue,[he,e("a",{href:(_=c.value)==null?void 0:_.content.href},o((a=c.value)==null?void 0:a.content.href),9,pe)]),e("div",ve,[ge,e("span",fe,o((v=c.value)==null?void 0:v.content.time),1)]),e("div",me,[be,e("span",ke,o((b=c.value)==null?void 0:b.source),1)]),e("div",we,[xe,e("span",Ce,o((P=c.value)==null?void 0:P.content.type),1)]),e("div",ye,[Le,e("span",$e,o((E=c.value)==null?void 0:E.content.target_element),1)]),e("div",Ue,[Se,e("div",Pe,[(u(!0),d(j,null,B((I=c.value)==null?void 0:I.content.stacks,(r,i)=>(u(),d("div",{class:"stack-item",key:i},[e("div",{onClick:y=>z(r,i)},"* "+o(r),9,Ee),m.value[i]?(u(),d("div",Ie,[e("span",null,o(m.value[i]),1)])):L("",!0),typeof p.value[i]=="string"?(u(),d("div",Ne,[e("a",{href:p.value[i],target:"_blank"},o(p.value[i]),9,je)])):L("",!0)]))),128))])]),e("div",Be,[Fe,e("span",Ve,o((N=c.value)==null?void 0:N.content.user_agent),1)])])])])])])}}}),Te=W(De,[["__scopeId","data-v-3c2c01c8"]]);export{Te as default};
//# sourceMappingURL=error-report-DBP5NiOe.js.map
